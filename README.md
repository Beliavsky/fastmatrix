source code from R fastmatrix package by Felipe Osorio and Alonso Ogueda
